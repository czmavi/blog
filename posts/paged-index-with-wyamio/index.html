<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-0f34a08d4f6dfb2d1d29.js" as="script"/><link rel="preload" href="/component---src-templates-blog-post-js-f572bac9321e04819adb.js" as="script"/><link rel="preload" href="/path---posts-paged-index-with-wyamio-72b531ac6a2b5cebf219.js" as="script"/><link rel="preload" href="/app-978785db40f8b7be366c.js" as="script"/><link rel="preload" href="/commons-8bfbcae085fbdcbff4ac.js" as="script"/><title data-react-helmet="true">Martin Vích&#x27;s blog | Paged index with Wyam.io</title><link data-react-helmet="true" rel="shortcut icon" type="image/x-icon" href="/favicon.png"/><link data-react-helmet="true" rel="icon" type="image/x-icon" href="/favicon.png"/><link data-react-helmet="true" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link data-react-helmet="true" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/><link data-react-helmet="true" href="/css/highlight.css" rel="stylesheet"/><link data-react-helmet="true" href="/css/clean-blog.css" rel="stylesheet"/><link data-react-helmet="true" href="/css/master.css" rel="stylesheet"/><link data-react-helmet="true" href="/css/override.css" rel="stylesheet"/><meta data-react-helmet="true" name="application-name" content="Martin Vích&#x27;s blog"/><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><meta data-react-helmet="true" name="msapplication-tooltip" content="Martin Vích&#x27;s blog"/><meta data-react-helmet="true" name="msapplication-starturl" content="/"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><style id="gatsby-inlined-css">.navbar.navbar-default{background-color:#333}.navbar .navbar-brand{font-weight:800}.navbar .navbar-header>a.navbar-brand{color:#fff}.navbar .navbar-header>a.navbar-brand:hover{color:#c3c2c2}.navbar ul.navbar-nav>li a{padding-top:0;padding-bottom:0;margin-top:15px;margin-bottom:15px;color:#fff}.navbar ul.navbar-nav>li a:hover{color:#c3c2c2}#navbar>ul.navbar-nav>li>a:hover,ul.navbar-nav>li>a:hover{color:#fff}@media only screen and (min-width:768px){ul.navbar-nav>li:nth-last-of-type(n+2)>a{border-right:1px solid #fff}.navbar.navbar-default{position:absolute;top:0;left:0;width:100%;z-index:3;font-family:Open Sans,Helvetica Neue,Helvetica,Arial,sans-serif;background:transparent;border-bottom:none}}@media (max-width:767px){.navbar.navbar-default .navbar-toggle,.navbar.navbar-default .navbar-toggle:hover{background-color:transparent}.navbar.navbar-default .navbar-toggle .icon-bar{background-color:#fff}}@media (max-width:767px){.intro-header{display:none}}.tags{min-height:20em}.tags .btn{margin-bottom:6px}.tags .btn-sm{font-size:12px;padding:5px 10px;margin-right:5px}.tags .btn-xs{font-size:12px;padding:1px 5px}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="-589976518"><!-- react-empty: 2 --><nav default="" class="navbar navbar-default" data-reactid="3"><div class="container" data-reactid="4"><div class="navbar-header" data-reactid="5"><a class="navbar-brand navbar-brand" href="/" data-reactid="6">Martin Vích</a><button type="button" class="navbar-toggle collapsed" data-reactid="7"><span class="sr-only" data-reactid="8">Toggle navigation</span><span class="icon-bar" data-reactid="9"></span><span class="icon-bar" data-reactid="10"></span><span class="icon-bar" data-reactid="11"></span></button></div><div class="navbar-collapse collapse" data-reactid="12"><ul class="nav navbar-nav navbar-right" data-reactid="13"><li role="presentation" data-reactid="14"><a href="/about" data-reactid="15">About</a></li><li role="presentation" data-reactid="16"><a href="/tags" data-reactid="17">Tags</a></li></ul></div></div></nav><header class="intro-header" id="intro-header" data-reactid="18"><div class="container" data-reactid="19"><div class="row" data-reactid="20"><div class="col-md-12" data-reactid="21"><svg style="display:none;" xmlns="http://www.w3.org/2000/svg" class="img-responsive center-block" width="150px" height="150px" data-reactid="22"><defs data-reactid="23"><pattern id="image" x="0" y="0" patternUnits="userSpaceOnUse" width="150" height="150" data-reactid="24"><image x="0" y="0" width="150" height="150" xlink:href="/img/logo_MV_noname.png" data-reactid="25"></image></pattern></defs><rect id="bg" x="0" y="0" width="150" height="150" fill="url(#image)" data-reactid="26"></rect><text x="75" y="124" text-anchor="middle" fill="#2E475B" font-size="16" id="name" data-reactid="27">Martin Vích</text></svg><div class="site-heading" data-reactid="28"><h1 data-reactid="29">Martin Vích&#x27;s blog</h1><hr class="small" data-reactid="30"/><span class="subheading" data-reactid="31">Hi I&#x27;m Martin Vích. For a long time I was working as a ASP.NET developer, now I&#x27;m focusing mainly on the front end.</span></div></div></div></div></header><div class="container" data-reactid="32"><div class="blog-post-container" data-reactid="33"><!-- react-empty: 34 --><div class="blog-post" data-reactid="35"><h1 data-reactid="36">Paged index with Wyam.io</h1><div class="blog-post-content" data-reactid="37"><p>I've decided to create new blog to share experiences I have with various peaces of software and since I'm doing a lot of .NET development <a href="http://wyam.io">Wyam.io</a> project caught my eye. It comes with everything I expected to need for a "begginers" blogging tool so I decided to give it a try. </p>
<p>It's really easy to use but there was one thing that I wanted to adjust. And that is how "index" page works by default. I didn't want it to show first few top post but instead I want it to have paging itself, not just on archive page. Using paginate in a separate pipeline is quite easy but problem is that you cannot just copy input/index.cshtml from the <a href="https://github.com/Wyamio/Wyam/tree/develop/examples/Pagination">pagination example</a> into your root index.cshtml. That would break your pipelines from the blog recipe.</p>
<p>Fortunately with just few adjustments it's possible to make it work that way.</p>
<h2>Config.wyam</h2>
<p>First we'll make some changes to <code>config.wyam</code>. We need to create a setting for the number of posts per page and also add new pipeline that will be responsible for creating paged index.</p>
<pre><code>Settings["PostsPerPage"] = 3;

Pipelines.Add("Archive",
    ReadFiles("index.cshtml"),
    Paginate(3,
        Documents(BlogPipelines.Posts),
        OrderBy((doc, ctx) => doc.Metadata.Get&#x3C;DateTime>("Published"))
    ),
    Razor(),
    WriteFiles(string.Format("{0}.html", @doc.Get&#x3C;int>("CurrentPage")))
);
</code></pre>
<h2>Index.cshtml</h2>
<p>Now configuration is done and we can move to the index file. We could copy <a href="https://github.com/Wyamio/Wyam/blob/develop/examples/Pagination/input/index.cshtml">posts index</a> into application root but problem with that is that the Blog template won't work anymore since the new index file expects pagination metedata which Blog pipelines aren't providing. Also the example index doesn't use _Layout and other things we probably want to keep. So instead let's copy <a href="https://github.com/Wyamio/Wyam/blob/develop/themes/Blog/CleanBlog/index.cshtml">index from the CleanBlog theme</a> and add paging there.</p>
<p>First we'll focus on the part where the posts are rendered</p>
<pre><code>@{
    int page = Model.ContainsKey("CurrentPage") ? Model.Get&#x3C;int>("CurrentPage") : 1;
    int postsPerPage = Context.Get&#x3C;int>("PostsPerPage");
    int totalPages = (Documents[BlogKeys.Posts].Count() / postsPerPage) + ((Documents[BlogKeys.Posts].Count() % postsPerPage) > 0 ? 1 : 0);
    bool first = true;
    foreach(IDocument doc in Documents[BlogKeys.Posts].Skip((page - 1) * postsPerPage).Take(postsPerPage))
    {
        // You don't have to change individual posts rendering
    }
}
</code></pre>
<p>This will ensure that when index file gets processed by Blog pipeline it will have reasonable default metadata and won't throw any exception.</p>
<p>Once that's done the only thing left is to add navigation between pages. You can add it right after the post rendering block</p>
<pre><code>    &#x3C;div>
        @for(int p = 1 ; p &#x3C;= totalPages ; p++)
        {
            &#x3C;span>
                @if(p == page)
                {
                    &#x3C;strong>Page @p&#x3C;/strong>
                }   
                else
                {
                    string pageLink = p == 1 ? "/" : p.ToString();
                    &#x3C;a href="@pageLink">Page @p&#x3C;/a>
                }
                &#x26;nbsp;&#x26;nbsp;
            &#x3C;/span>
        }
    &#x3C;/div>
</code></pre>
<p>This will add Page 1 to Page N links under your posts. You can also adjust this logic to show Older / New posts links.</p>
<p>I hope that this will help you with adjusting your Wyam site.</p></div></div></div></div><hr data-reactid="38"/><footer class="footer" data-reactid="39"><div class="container" data-reactid="40"><div class="row" data-reactid="41"><div class="col-md-8" data-reactid="42"><p class="logo" data-reactid="43"><img src="/img/logo_MV_bw.png" width="41" height="40" data-reactid="44"/><!-- react-text: 45 --> Martin Vích<!-- /react-text --></p><p class="copyright" data-reactid="46"><!-- react-text: 47 -->© <!-- /react-text --><!-- react-text: 48 -->2018<!-- /react-text --><!-- react-text: 49 --> Martin Vích<!-- /react-text --><br data-reactid="50"/><a href="/rss.xml" data-reactid="51"><i class="fa fa-rss" data-reactid="52"></i><!-- react-text: 53 --> RSS Feed<!-- /react-text --></a><!-- react-text: 54 --> | <!-- /react-text --><a href="https://github.com/czmavi/blog" data-reactid="55"><i class="fa fa-github" data-reactid="56"></i><!-- react-text: 57 --> Source<!-- /react-text --></a></p></div><div class="col-md-4" data-reactid="58"><p data-reactid="59">Find me at</p><p class="contact_icons" data-reactid="60"><a href="https://www.facebook.com/martin.vich.5" rel="noopener" target="_blank" data-reactid="61"><img src="/img/fb_ico.png" data-reactid="62"/></a><a href="https://cz.linkedin.com/in/vichmartin" rel="noopener" target="_blank" data-reactid="63"><img src="/img/linkedin_ico.png" data-reactid="64"/></a><a href="https://twitter.com/MaVi_cz" rel="noopener" target="_blank" data-reactid="65"><img src="/img/twitter_ico.png" data-reactid="66"/></a></p></div></div></div></footer></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-978785db40f8b7be366c.js","107818501498521":"component---src-templates-blog-post-js-f572bac9321e04819adb.js","47374121688406":"component---src-templates-tag-category-js-9ca9115231740c91b032.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","263791100135453":"component---src-pages-about-js-25f757a1ed4fd2100b57.js","35783957827783":"component---src-pages-index-js-065fd618df181339786b.js","195850678278728":"component---src-pages-tags-js-947e9c0dc3a4fa9114eb.js","60335399758886":"path----77f5a612744acc119c81.js","117075556066768":"path---posts-using-git-on-windows-bd8b329e3de038796ae4.js","88399842002353":"path---posts-paged-index-with-wyamio-72b531ac6a2b5cebf219.js","224989948613620":"path---tags-git-d5bec265f59039cef34a.js","114842950261596":"path---tags-windows-afefe1ca538362f3b608.js","224724755954515":"path---tags-powershell-ba751e8c5bd2b34fb8de.js","4795777609049":"path---tags-wyam-3fccb12e6f533e408632.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","273950069227526":"path---about-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-5ab21ea013450a32091b.js","55702396619907":"path---tags-48f8bef912587a560bfd.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-0f34a08d4f6dfb2d1d29.js"}/*]]>*/</script><script>/*<![CDATA[*/["/commons-8bfbcae085fbdcbff4ac.js","/app-978785db40f8b7be366c.js","/path---posts-paged-index-with-wyamio-72b531ac6a2b5cebf219.js","/component---src-templates-blog-post-js-f572bac9321e04819adb.js","/component---src-layouts-index-js-0f34a08d4f6dfb2d1d29.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>